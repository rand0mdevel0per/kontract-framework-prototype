name = "kontract-demo"
main = "src/gateway.ts"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

# ── Durable Objects ──────────────────────────────────────
[durable_objects]
bindings = [
  { name = "SESSION_DO", class_name = "KontractSessionDO" },
]

[[migrations]]
tag = "v1"
new_classes = ["KontractSessionDO"]

# ── Environment Variables ────────────────────────────────
# Set via `wrangler secret put`:
#   wrangler secret put DATABASE_URL
#   wrangler secret put KONTRACT_SECRET
#
# DATABASE_URL     — PostgreSQL connection string
# KONTRACT_SECRET  — 32-byte hex key for raystream encryption

# ── Per-environment overrides ────────────────────────────
[env.production]
name = "kontract-demo"
# routes = [
#   { pattern = "api.example.com/*", zone_name = "example.com" }
# ]

[env.staging]
name = "kontract-demo-staging"
